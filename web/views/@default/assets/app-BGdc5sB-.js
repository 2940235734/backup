import{r as $,o as a,g as n,b as i,d as g,e as v,u as t,a as d,h as m,w as r,f as c,i as f,F as D,t as k,D as V,c as b,n as I}from"./app-DjYJfrF8.js";import{i as w,c as S}from"./app-C1XH7PtB.js";import{_ as x}from"./app-3vC1yvcU.js";import{_ as E}from"./app-DI3fcpfR.js";import{_ as A}from"./app-mO6x4u2P.js";import{T as p}from"./app-DA-qpgNO.js";import{_ as C}from"./app-BWoLk5mp.js";import{_ as N}from"./app-BWgYuRpK.js";import{_ as U}from"./app-DARP0P5r.js";import{_ as z}from"./app-BV2rgPOF.js";import{L as B}from"./app-BOEypwYT.js";import{_}from"./app-BMxA-yCD.js";import{_ as T}from"./app-CyF-K2SP.js";import"./app-D3zb-bsA.js";import"./app-BUF1jp6-.js";import"./app-C957O1lC.js";import"./app-DPFGrewt.js";import"./app-DPmFMerm.js";import"./app-BDyHR7S0.js";import"./app-DQcJZ4rR.js";import"./app-CzGZEE3n.js";import"./app-C8URsP3D.js";import"./app-__35K3dS.js";import"./app-CQoUplHC.js";import"./app-DYZ72m3h.js";import"./app-DDxM4xJi.js";import"./app-CMoUOWYK.js";import"./app-DqyEP-Ic.js";import"./app-BZpo3xeX.js";import"./app-3rCQf5Hi.js";import"./app-l8Q5NmGb.js";import"./app-CMrnp7LG.js";import"./app-zaKueCu1.js";import"./app-CXb0aRmx.js";import"./app-PXD802g2.js";import"./app-Bx1vQSc6.js";import"./app-g_ZjR39Z.js";import"./app-BOdfUA0H.js";import"./app-RjwKLjbv.js";import"./app-B3JHJgWn.js";import"./app-C6feLE3_.js";function G(){const{utils:h,Tea:y}=w(this);this.$delay(function(){this.changeUserId(this.userId)}),this.deleteDomain=function(e){let o=this;h.confirm("确定要删除此域名吗？",function(){o.$post("/ns/domains/delete").params({domainId:e}).success(function(){h.reload()})})},this.verifyDomain=function(e){h.popup("/ns/domains/domain/verifyPopup?domainId="+e,{callback:function(){}})},this.hasGroups=!1,this.changeUserId=function(e){this.$post("/ns/domains/groups/options").params({userId:e}).success(function(o){this.hasGroups=o.data.groups.length>0,this.hasGroups&&this.$delay(function(){this.$refs.groupSelector.reload(e)})})},this.selectedAll=!1,this.hasSelectedDomains=!1,this.hasVerifyingDomains=!1,this.$delay(function(){this.$watch(()=>this.selectedAll,()=>{this.selectedAll?(this.hasSelectedDomains=!0,this.domains.forEach(e=>{e.isChecked=!0})):(this.hasSelectedDomains=!1,this.domains.forEach(e=>{e.isChecked=!1}),this.hasVerifyingDomains=!1),this.hasVerifyingDomains=this.domains.$find((e,o)=>o.status=="none")!=null})}),this.changeDomainChecked=function(e){this.hasSelectedDomains=!1,this.hasVerifyingDomains=!1,this.domains.forEach(o=>{o.isChecked&&(this.hasSelectedDomains=!0,o.status=="none"&&(this.hasVerifyingDomains=!0))})},this.cancelDomains=function(){this.domains.forEach(e=>{e.isChecked=!1}),this.selectedAll=!1,this.hasSelectedDomains=!1,this.hasVerifyingDomains=!1},this.deleteDomains=function(){let e=[];this.domains.forEach(o=>{o.isChecked&&e.push(o.id)}),e.length!=0&&h.confirm("确定要删除选中的域名吗？",function(){this.$post(".deletePage").params({domainIds:e}).success(function(){h.successRefresh("删除成功")})})},this.verifyDomains=function(){let e=[];this.domains.forEach(o=>{o.isChecked&&o.status=="none"&&e.push(o.id)}),e.length!=0&&h.confirm("html:确定要批量验证选中的域名吗？<br/>在此之前请确保这些域名已经设置了NS记录。<br/>已经验证过的域名，不再重复验证。",function(){this.$post(".verifyPage").params({domainIds:e}).success(function(){h.successRefresh("验证成功")})})}}const L={method:"get",action:"/ns/domains"},P={class:"ui fields inline"},R={key:0,class:"ui field"},F={class:"ui field"},O={class:"ui field"},j=["href"],M=d("div",{class:"ui field"},null,-1),q={class:"ui fields inline"},H={class:"ui field"},J={key:0,class:"ui field"},K={class:"ui field"},Q={key:0},W={key:1,class:"mt-4"},X=["href"],Y={key:0,class:"label-group mt-1"},Z=["href"],ee={key:0,class:"red"},se={key:1},te=["onClick"],ie=d("span",{class:"red",style:{"border-bottom":"1px #db2828 dashed"}},"未验证",-1),oe=[ie],ae=["href"],ne=["onClick"],Ke={__name:"index",setup(h){const y=$(),e=S(new G,{refs:{groupSelector:y}});return(o,u)=>(a(),n(D,null,[i(x,{"active-tab":"index"}),g(d("form",L,[d("div",P,[t(e).hasGroups?(a(),n("div",R,[i(E,{"v-domain-group-id":t(e).groupId,ref_key:"groupSelector",ref:y},null,8,["v-domain-group-id"])])):m("",!0),d("div",F,[i(A,{name:"keyword",modelValue:t(e).keyword,"onUpdate:modelValue":u[0]||(u[0]=s=>t(e).keyword=s),placeholder:"域名..."},null,8,["modelValue"])]),d("div",O,[i(p,{secondary:"",type:"submit"},{default:r(()=>[c("搜索")]),_:1}),c("   "),t(e).groupId>0||t(e).keyword.length>0?(a(),n("a",{key:0,href:t(e).$url(".")},"[清除条件]",8,j)):m("",!0)]),M])],512),[[v,!t(e).hasSelectedDomains]]),g(d("form",null,[d("div",q,[d("div",H,[i(p,{secondary:"",outlined:"",type:"button",onClick:f(t(e).cancelDomains,["prevent"])},{default:r(()=>[c("取消选中")]),_:1},8,["onClick"])]),t(e).hasVerifyingDomains?(a(),n("div",J,[i(p,{secondary:"",outlined:"",type:"button",onClick:f(t(e).verifyDomains,["prevent"])},{default:r(()=>[c("批量验证选中域名")]),_:1},8,["onClick"])])):m("",!0),d("div",K,[i(p,{secondary:"",outlined:"",type:"button",onClick:f(t(e).deleteDomains,["prevent"])},{default:r(()=>[c("批量删除选中域名")]),_:1},8,["onClick"])])])],512),[[v,t(e).hasSelectedDomains]]),t(e).domains.length==0?(a(),n("div",Q,[i(T,null,{default:r(()=>[c("暂时还没有域名。")]),_:1})])):m("",!0),t(e).domains.length>0?(a(),n("div",W,[i(B,{items:t(e).domains},{default:r(()=>[i(_,{class:"checkbox-column",frozen:""},{header:r(()=>[i(C,{modelValue:t(e).selectedAll,"onUpdate:modelValue":u[1]||(u[1]=s=>t(e).selectedAll=s)},null,8,["modelValue"])]),body:r(({data:s})=>[i(C,{modelValue:s.isChecked,"onUpdate:modelValue":l=>s.isChecked=l,onChange:l=>t(e).changeDomainChecked(s)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),i(_,{header:"域名",frozen:""},{body:r(({data:s})=>[d("a",{href:"/ns/domains/domain?domainId="+s.id},[i(U,{"v-word":t(e).keyword},{default:r(()=>[c(k(s.name),1)]),_:2},1032,["v-word"])],8,X),s.groups.length>0?(a(),n("div",Y,[(a(!0),n(D,null,V(s.groups,l=>(a(),n("a",{href:"/ns/domains?userId="+l.userId+"&groupId="+l.id},[(a(),b(N,{key:l.id},{default:r(()=>[c(k(l.name),1)]),_:2},1024))],8,Z))),256))])):m("",!0)]),_:1}),i(_,{header:"状态",class:"fixed-status-column"},{body:r(({data:s})=>[s.isOn?m("",!0):(a(),n("span",ee,"已停用")),s.isOn?(a(),n("span",se,[s.status=="none"?(a(),n("a",{key:0,href:"",onClick:f(l=>t(e).verifyDomain(s.id),["prevent"])},oe,8,te)):(a(),n("span",{key:1,class:I({green:s.status=="verified",red:s.status=="rejected"||s.status=="forbidden"})},k(s.statusName),3))])):m("",!0)]),_:1}),i(_,{header:"操作",class:"two op",frozen:"","align-frozen":"right"},{body:r(({data:s})=>[d("a",{href:"/ns/domains/domain?domainId="+s.id},"详情",8,ae),c("   "),d("a",{href:"",onClick:f(l=>t(e).deleteDomain(s.id),["prevent"])},"删除",8,ne)]),_:1})]),_:1},8,["items"]),i(z,{data:t(e).page},null,8,["data"])])):m("",!0)],64))}};export{Ke as default};
